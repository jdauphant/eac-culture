<!DOCTYPE html>
<html>
<head>
   <title>Sorties Blaise Pascal</title>

   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0">

   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
   <link rel="stylesheet" href="https://rawgit.com/Leaflet/Leaflet.markercluster/v1.2.0/dist/MarkerCluster.css" />
   <link rel="stylesheet" href="https://rawgit.com/Leaflet/Leaflet.markercluster/v1.2.0/dist/MarkerCluster.Default.css" />
   <link rel="stylesheet" href="https://cdn.rawgit.com/Pixabay/JavaScript-autoComplete/1.0.4/auto-complete.css" />
   <link rel="stylesheet" href="https://opensource.keycdn.com/fontawesome/4.7.0/font-awesome.min.css" integrity="sha384-dNpIIXE8U05kAbPhy3G1cz+yZmTzA6CY8Vg/u2L9xRnHjJiAK76m2BIEaSEV+/aU" crossorigin="anonymous">
   <link rel="stylesheet" href="index.css" />
   <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
   <script src="https://rawgit.com/Leaflet/Leaflet.markercluster/v1.2.0/dist/leaflet.markercluster.js"></script>
   <script src="https://cdn.rawgit.com/Pixabay/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
   <style type="text/css">
       html, body { 
           height: 100%; 
           margin: 0; 
           padding: 0;
       }
       #map {
           height: 100%;
           display: block;
       }
       .address {
           width: 300px;
           position: absolute;
           padding: 5px;
           top: 10px;
           left: 55px;
       }
   </style>

</head>

<body>
<div class="header">
        <div class="header__avatar">
        </div>
    
    <div class="header__favorites">
    </div>
</div>
<div class="main">
<div class="galery galery--force-scrollbar">
    <div class="galery__card galery__card--clickable">
        <img class="galery__card__image" src="images/icons/music-conductor-filled-50.png">
        <h2 class="galery__card__title">Orchestre national d'Île-de-France</h2>
        <p class="galery__card__description">Formation symphonique de notoriété internationale, l'Orchestre national d'Île-de-France propose une centaine de concerts par an. Sa mission : la diffusion du répertoire symphonique en Île-de-France.
        </p>
        <div class="galery__card__bottom">
            12 projets EAC avec 3 établissements scolaires
        </div>
    </div>
    <div class="galery__card galery__card--clickable">
            <img class="galery__card__image" src="images/icons/theatre-mask-filled-50.png"/>
            <h2 class="galery__card__title">Théâtre National de Chaillot</h2>
            <p class="galery__card__description">Le théâtre National de Chaillot accueille le public dans ses 3 salles. Ce théâtre national propose une programmation basée sur la danse contemporaine et le théâtre. Propose des ateliers théâtres et rencontres culturelles.
            </p>
            <div class="galery__card__bottom">
                25 projets EAC avec 15 établissements scolaires
            </div>
        </div>
        <div class="galery__card galery__card--clickable">
                <img class="galery__card__image" src="images/icons/museum-filled-50.png"/>
                <h2 class="galery__card__title">Musée d'Orsay</h2>
                <p class="galery__card__description">Le musée possède la plus importante collection de peintures impressionnistes et post-impressionnistes au monde, avec près de 1 100 toiles au total sur plus de 3 450.  Des expositions temporaires monographiques ou thématiques concernent périodiquement l’œuvre d’un artiste, un courant ou une question d’histoire de l’art.
                </p>
                <div class="galery__card__bottom">
                    55 projets EAC avec 40 établissements
                </div>
            </div>
            <div class="galery__card galery__card--clickable">
                    <img class="galery__card__image" src="images/icons/music-conductor-filled-50.png"/>
                    <h2 class="galery__card__title">Orchestre national d'Île-de-France</h2>
                    <p class="galery__card__description">Formation symphonique de notoriété internationale, l'Orchestre national d'Île-de-France propose une centaine de concerts par an. Sa mission : la diffusion du répertoire symphonique en Île-de-France.
                    </p>
                    <div class="galery__card__bottom">
                        12 projets EAC avec 3 établissements scolaires
                    </div>
                </div>
                <div class="galery__card galery__card--clickable">
                        <img class="galery__card__image" src="images/icons/theatre-mask-filled-50.png"/>
                        <h2 class="galery__card__title">Théâtre National de Chaillot</h2>
                        <p class="galery__card__description">Le théâtre National de Chaillot accueille le public dans ses 3 salles. Ce théâtre national propose une programmation basée sur la danse contemporaine et le théâtre. Propose des ateliers théâtres et rencontres culturelles.
                        </p>
                        <div class="galery__card__bottom">
                            25 projets EAC avec 15 établissements scolaires
                        </div>
                    </div>
                    <div class="galery__card galery__card--clickable">
                            <img class="galery__card__image" src="images/icons/museum-filled-50.png"/>
                            <h2 class="galery__card__title">Musée d'Orsay</h2>
                            <p class="galery__card__description">Le musée possède la plus importante collection de peintures impressionnistes et post-impressionnistes au monde, avec près de 1 100 toiles au total sur plus de 3 450.  Des expositions temporaires monographiques ou thématiques concernent périodiquement l’œuvre d’un artiste, un courant ou une question d’histoire de l’art.
                            </p>
                            <div class="galery__card__bottom">
                                55 projets EAC avec 40 établissements
                            </div>
                        </div>     
</div>
<div id="map">
</div>
</div>
<script>
   var center = { lat: 47.398659, lng: 2.195567 };

// Map
   var map = L.map('map', {
       drawControl: true,
       center: center,
       zoom: 6,
       minZoom: 6
   });

   L.tileLayer(
    'http://{s}.tile.openstreetmap.fr/openriverboatmap/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> Contributors & <a href="http://openstreetmap.fr/">OSM FR</a>',
    maxZoom: 18,
    }).addTo(map);

   var activitesRequest = new XMLHttpRequest();
   activitesRequest.open('GET', 'blaise-pascal.json', true); 
   activitesRequest.onload = function() {
   if (activitesRequest.status >= 200 && activitesRequest.status < 400) {
       // Success!
       var data = JSON.parse(activitesRequest.responseText);
      
       L.geoJson(data, {
                           pointToLayer: function(geoJson, latlng) {
                                var marker;
                                if(geoJson["properties"]["lib_nature"] == "COLLEGE") {
                                    var icon = L.divIcon({
                                        html: "C", 
                                        className: 'icon__label icon__label--green',
                                        iconSize: [18,18]
                                    });
                                    marker = L.marker(latlng, {icon: icon});
                                } else if(geoJson["properties"]["type"] == "THEATRE" ) {
                                    var icon = L.divIcon({
                                        html: "<img src='images/icons/theatre-mask-filled-50.png' style='width: 70%; margin: 15%;'>", 
                                        className: 'icon__label icon__label--no-border',
                                        iconSize: [25,25]
                                    });
                                    marker = L.marker(latlng, {icon: icon});
                                } else if(geoJson["properties"]["type"] == "CINEMA" ) {
                                    var icon = L.divIcon({
                                        html: "<img src='images/icons/movie-filled-50.png' style='width: 70%; margin: 15%;'>", 
                                        className: 'icon__label icon__label--no-border',
                                        iconSize: [25,25]
                                    });
                                    marker = L.marker(latlng, {icon: icon});
                                } else if(geoJson["properties"]["nom_du_musee"] != undefined ) {
                                    var icon = L.divIcon({
                                        html: "<img src='images/icons/museum-filled-50.png' style='width: 70%; margin: 15%;'>", 
                                        className: 'icon__label icon__label--no-border',
                                        iconSize: [25,25]
                                    });
                                    marker = L.marker(latlng, {icon: icon});
                                } else {
                                    marker = L.marker(latlng);
                                }
                               try { 
                                     marker.bindPopup("<b>"+geoJson["properties"]["courses"][0]["companieName"]+"</b> <br> "+geoJson["properties"]["courses"][0]["title"]);
                                } catch(e){
                                    if(geoJson["properties"]["nom_du_musee"] != undefined) {
                                        marker.bindPopup("<b>"+geoJson["properties"]["nom_du_musee"]+"</b>");
                                    } else if(geoJson["properties"]["name"] != undefined) {
                                        marker.bindPopup("<b>"+geoJson["properties"]["name"]+"</b>");
                                    }
                                }
                               return marker;
                           }
                       })
       .addTo(map);
       var center = data["features"][0]["geometry"]["coordinates"];
       center = center.reverse();
       var array = Array.from(data["features"]);
       array.shift();
       array.forEach(function(element) {
           var point = element["geometry"]["coordinates"];
           point = point.reverse();
           var points = [center,point];
           var polyline = L.polyline(points, {color: 'blue'}).addTo(map);
       });
       map.flyTo(center, 10); 
   } else {
   }
   };
   activitesRequest.send();

</script>
</body>
</html>
